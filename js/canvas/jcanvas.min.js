"use strict";var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};!function(e,t,r){"object"===("undefined"==typeof module?"undefined":_typeof(module))&&"object"===_typeof(module.exports)?module.exports=function(e,t){return r(e,t)}:r(e,t)}("undefined"!=typeof window?window.jQuery:{},"undefined"!=typeof window?window:void 0,function(e,t){function r(e){var t,r=this;for(t in e)Object.prototype.hasOwnProperty.call(e,t)&&(r[t]=e[t]);return r}function n(){ye(this,n.baseDefaults)}function a(e){return"string"===we(e)}function o(e){return"function"===we(e)}function i(e){return!isNaN(ve(e))&&!isNaN(pe(e))}function s(e){return e&&e.getContext?e.getContext("2d"):null}function l(e){var t,r;for(t in e)Object.prototype.hasOwnProperty.call(e,t)&&(r=e[t],"string"===we(r)&&i(r)&&"text"!==t&&(e[t]=pe(r)));void 0!==e.text&&(e.text=String(e.text))}function u(e){return e=ye({},e),e.masks=e.masks.slice(0),e}function d(e,t){var r;e.save(),r=u(t.transforms),t.savedTransforms.push(r)}function c(e,t){0===t.savedTransforms.length?t.transforms=u(Xe):(e.restore(),t.transforms=t.savedTransforms.pop())}function h(e,t,r,n){r[n]&&(o(r[n])?t[n]=r[n].call(e,r):t[n]=r[n])}function f(e,t,r){h(e,t,r,"fillStyle"),h(e,t,r,"strokeStyle"),t.lineWidth=r.strokeWidth,r.rounded?t.lineCap=t.lineJoin="round":(t.lineCap=r.strokeCap,t.lineJoin=r.strokeJoin,t.miterLimit=r.miterLimit),r.strokeDash||(r.strokeDash=[]),t.setLineDash&&t.setLineDash(r.strokeDash),t.webkitLineDash=r.strokeDash,t.lineDashOffset=t.webkitLineDashOffset=t.mozDashOffset=r.strokeDashOffset,t.shadowOffsetX=r.shadowX,t.shadowOffsetY=r.shadowY,t.shadowBlur=r.shadowBlur,t.shadowColor=r.shadowColor,t.globalAlpha=r.opacity,t.globalCompositeOperation=r.compositing,r.imageSmoothing&&(t.imageSmoothingEnabled=r.imageSmoothing)}function g(e,t,r){r.mask&&(r.autosave&&d(e,t),e.clip(),t.transforms.masks.push(r._args))}function v(e,t){t._transformed&&e.restore()}function p(e,t,r){var n;r.closed&&t.closePath(),r.shadowStroke&&0!==r.strokeWidth?(t.stroke(),t.fill(),t.shadowColor="transparent",t.shadowBlur=0,t.stroke()):(t.fill(),"transparent"!==r.fillStyle&&(t.shadowColor="transparent"),0!==r.strokeWidth&&t.stroke()),r.closed||t.closePath(),v(t,r),r.mask&&(n=m(e),g(t,n,r))}function y(e,t,r,n,a){r._toRad=r.inDegrees?be/180:1,r._transformed=!0,t.save(),r.fromCenter||r._centered||void 0===n||(void 0===a&&(a=n),r.x+=n/2,r.y+=a/2,r._centered=!0),r.rotate&&N(t,r,null),1===r.scale&&1===r.scaleX&&1===r.scaleY||M(t,r,null),(r.translate||r.translateX||r.translateY)&&J(t,r,null)}function m(t){var r,n=Pe.dataCache;return n._canvas===t&&n._data?r=n._data:(r=e.data(t,"jCanvas"),r||(r={canvas:t,layers:[],layer:{names:{},groups:{}},eventHooks:{},intersecting:[],lastIntersected:null,cursor:e(t).css("cursor"),drag:{layer:null,dragging:!1},event:{type:null,x:null,y:null},events:{},transforms:u(Xe),savedTransforms:[],animating:!1,animated:null,pixelRatio:1,scaled:!1,redrawOnMousemove:!1},e.data(t,"jCanvas",r)),n._canvas=t,n._data=r),r}function w(e,t,r){var n;for(n in je.events)Object.prototype.hasOwnProperty.call(je.events,n)&&(r[n]||r.cursors&&r.cursors[n])&&b(e,t,r,n);t.events.mouseout||(e.bind("mouseout.jCanvas",function(){var r,n=t.drag.layer;for(n&&(t.drag={},A(e,t,n,"dragcancel")),r=0;r<t.layers.length;r+=1)n=t.layers[r],n._hovered&&e.triggerLayerEvent(t.layers[r],"mouseout");e.drawLayers()}),t.events.mouseout=!0)}function x(e,t,r,n){je.events[n](e,t),r._event=!0}function b(e,t,r,n){x(e,t,r,n),"mouseover"!==n&&"mouseout"!==n&&"mousemove"!==n||(t.redrawOnMousemove=!0)}function _(e,t,r){var n,a,o;if(r.draggable||r.cursors){for(n=["mousedown","mousemove","mouseup"],o=0;o<n.length;o+=1)a=n[o],x(e,t,r,a);r._event=!0}}function k(e,t,r,n){var o=t.layer.names;n?void 0!==n.name&&a(r.name)&&r.name!==n.name&&delete o[r.name]:n=r,a(n.name)&&(o[n.name]=r)}function L(e,t,r,n){var a,o,i,s,l,u=t.layer.groups;if(n){if(void 0!==n.groups&&null!==r.groups)for(i=0;i<r.groups.length;i+=1)if(o=r.groups[i],a=u[o]){for(l=0;l<a.length;l+=1)if(a[l]===r){s=l,a.splice(l,1);break}0===a.length&&delete u[o]}}else n=r;if(void 0!==n.groups&&null!==n.groups)for(i=0;i<n.groups.length;i+=1)o=n.groups[i],a=u[o],a||(a=u[o]=[],a.name=o),void 0===s&&(s=a.length),a.splice(s,0,r)}function C(e){var t,r,n,a;for(t=null,r=e.intersecting.length-1;r>=0;r-=1)if(t=e.intersecting[r],t._masks){for(a=t._masks.length-1;a>=0;a-=1)if(n=t._masks[a],!n.intersects){t.intersects=!1;break}if(t.intersects&&!t.intangible)break}return t&&t.intangible&&(t=null),t}function S(e,t,r,n){r&&r.visible&&r._method&&(r._next=n||null,r._method&&r._method.call(e,r))}function T(e,t,r){var n,a,o,i,s,l,u,d,c,h;if(i=t.drag,a=i.layer,s=a&&a.dragGroups||[],n=t.layers,"mousemove"===r||"touchmove"===r){if(i.dragging||(i.dragging=!0,a.dragging=!0,a.bringToFront&&(n.splice(a.index,1),a.index=n.push(a)),a._startX=a.x,a._startY=a.y,a._endX=a._eventX,a._endY=a._eventY,A(e,t,a,"dragstart")),i.dragging)for(c=a._eventX-(a._endX-a._startX),h=a._eventY-(a._endY-a._startY),a.updateDragX&&(c=a.updateDragX.call(e[0],a,c)),a.updateDragY&&(h=a.updateDragY.call(e[0],a,h)),a.dx=c-a.x,a.dy=h-a.y,"y"!==a.restrictDragToAxis&&(a.x=c),"x"!==a.restrictDragToAxis&&(a.y=h),A(e,t,a,"drag"),d=0;d<s.length;d+=1)if(u=s[d],l=t.layer.groups[u],a.groups&&l)for(o=0;o<l.length;o+=1)l[o]!==a&&("y"!==a.restrictDragToAxis&&"y"!==l[o].restrictDragToAxis&&(l[o].x+=a.dx),"x"!==a.restrictDragToAxis&&"x"!==l[o].restrictDragToAxis&&(l[o].y+=a.dy))}else"mouseup"!==r&&"touchend"!==r||(i.dragging&&(a.dragging=!1,i.dragging=!1,t.redrawOnMousemove=t.originalRedrawOnMousemove,A(e,t,a,"dragstop")),t.drag={})}function O(t,r,n){var a;r.cursors&&(a=r.cursors[n]),-1!==e.inArray(a,Ae.cursors)&&(a=Ae.prefix+a),a&&t.css({cursor:a})}function R(e,t){e.css({cursor:t.cursor})}function P(e,t,r,n,a){n[r]&&t._running&&!t._running[r]&&(t._running[r]=!0,n[r].call(e[0],t,a),t._running[r]=!1)}function X(t,r){return!(t.disableEvents||t.intangible&&-1!==e.inArray(r,Ye))}function A(e,t,r,n,a){X(r,n)&&("mouseout"!==n&&O(e,r,n),P(e,r,n,r,a),P(e,r,n,t.eventHooks,a),P(e,r,n,je.eventHooks,a))}function Y(t,n,o,i){var s,u,d,c=n._layer?o:n;return n._args=o,(n.draggable||n.dragGroups)&&(n.layer=!0,n.draggable=!0),n._method||(i?n._method=i:n.method?n._method=e.fn[n.method]:n.type&&(n._method=e.fn[Re.drawings[n.type]])),n.layer&&!n._layer?(s=e(t),u=m(t),d=u.layers,(null===c.name||a(c.name)&&void 0===u.layer.names[c.name])&&(l(n),c=new r(n),c.canvas=t,c.layer=!0,c._layer=!0,c._running={},null!==c.data?c.data=ye({},c.data):c.data={},null!==c.groups?c.groups=c.groups.slice(0):c.groups=[],k(s,u,c),L(s,u,c),w(s,u,c),_(s,u,c),n._event=c._event,c._method===e.fn.drawText&&s.measureText(c),null===c.index&&(c.index=d.length),d.splice(c.index,0,c),n._args=c,A(s,u,c,"add"))):n.layer||l(n),c}function j(e){var t,r;for(r=0;r<Ae.props.length;r+=1)t=Ae.props[r],e[t]=e["_"+t]}function D(e,t){var r,n;for(n=0;n<Ae.props.length;n+=1)r=Ae.props[n],void 0!==e[r]&&(e["_"+r]=e[r],Ae.propsObj[r]=!0,t&&delete e[r])}function W(e,t,r){var n,a,i,s;for(n in r)if(Object.prototype.hasOwnProperty.call(r,n)&&(a=r[n],o(a)&&(r[n]=a.call(e,t,n)),"object"===we(a)&&xe(a))){for(i in a)Object.prototype.hasOwnProperty.call(a,i)&&(s=a[i],void 0!==t[n]&&(t[n+"."+i]=t[n][i],r[n+"."+i]=s));delete r[n]}return r}function z(e){var t;for(t in e)Object.prototype.hasOwnProperty.call(e,t)&&-1!==t.indexOf(".")&&delete e[t]}function H(t){var r,n,a=[],o=1;return"transparent"===t?t="rgba(0, 0, 0, 0)":t.match(/^([a-z]+|#[0-9a-f]+)$/gi)&&(n=de.head,r=n.style.color,n.style.color=t,t=e.css(n,"color"),n.style.color=r),t.match(/^rgb/gi)&&(a=t.match(/(\d+(\.\d+)?)/gi),t.match(/%/gi)&&(o=2.55),a[0]*=o,a[1]*=o,a[2]*=o,void 0!==a[3]?a[3]=pe(a[3]):a[3]=1),a}function E(e){var t,r=3;for("array"!==we(e.start)&&(e.start=H(e.start),e.end=H(e.end)),e.now=[],1===e.start[3]&&1===e.end[3]||(r=4),t=0;t<r;t+=1)e.now[t]=e.start[t]+(e.end[t]-e.start[t])*e.pos,t<3&&(e.now[t]=_e(e.now[t]));1!==e.start[3]||1!==e.end[3]?e.now="rgba("+e.now.join(",")+")":(e.now.slice(0,3),e.now="rgb("+e.now.join(",")+")"),e.elem.nodeName?e.elem.style[e.prop]=e.now:e.elem[e.prop]=e.now}function G(e){return Re.touchEvents[e]&&(e=Re.touchEvents[e]),e}function I(e){return Re.mouseEvents[e]&&(e=Re.mouseEvents[e]),e}function F(e){je.events[e]=function(t,r){function n(e){i.x=e.offsetX,i.y=e.offsetY,i.type=a,i.event=e,("mousemove"!==e.type||r.redrawOnMousemove||r.drag.dragging)&&t.drawLayers({resetFire:!0}),e.preventDefault()}var a,o,i;i=r.event,a="mouseover"===e||"mouseout"===e?"mousemove":e,o=G(a),r.events[a]||(o!==a?t.bind(a+".jCanvas "+o+".jCanvas",n):t.bind(a+".jCanvas",n),r.events[a]=!0)}}function B(e,t,r){var n,a,o,i,s,l,u,d;(n=r._args)&&(a=m(e),o=a.event,null!==o.x&&null!==o.y&&(l=o.x*a.pixelRatio,u=o.y*a.pixelRatio,i=t.isPointInPath(l,u)||t.isPointInStroke&&t.isPointInStroke(l,u)),s=a.transforms,n.eventX=o.x,n.eventY=o.y,n.event=o.event,d=a.transforms.rotate,l=n.eventX,u=n.eventY,0!==d?(n._eventX=l*Ce(-d)-u*Le(-d),n._eventY=u*Ce(-d)+l*Le(-d)):(n._eventX=l,n._eventY=u),n._eventX/=s.scaleX,n._eventY/=s.scaleY,i&&a.intersecting.push(n),n.intersects=Boolean(i))}function N(e,t,r){t._toRad=t.inDegrees?be/180:1,e.translate(t.x,t.y),e.rotate(t.rotate*t._toRad),e.translate(-t.x,-t.y),r&&(r.rotate+=t.rotate*t._toRad)}function M(e,t,r){1!==t.scale&&(t.scaleX=t.scaleY=t.scale),e.translate(t.x,t.y),e.scale(t.scaleX,t.scaleY),e.translate(-t.x,-t.y),r&&(r.scaleX*=t.scaleX,r.scaleY*=t.scaleY)}function J(e,t,r){t.translate&&(t.translateX=t.translateY=t.translate),e.translate(t.translateX,t.translateY),r&&(r.translateX+=t.translateX,r.translateY+=t.translateY)}function q(e){for(;e<0;)e+=2*be;return e}function Q(e,t){return e.x+e.radius*Ce(t)}function V(e,t){return e.y+e.radius*Le(t)}function $(e,t,r,n){var a,o,i,s,l,u,d,c,h,f,g;r===n?(h=0,f=0):(h=r.x,f=r.y),n.inDegrees||360!==n.end||(n.end=2*be),n.start*=r._toRad,n.end*=r._toRad,n.start-=be/2,n.end-=be/2,g=be/180,n.ccw&&(g*=-1),a=Q(n,n.start+g),o=V(n,n.start+g),i=Q(n,n.start),s=V(n,n.start),K(e,t,r,n,a,o,i,s),t.arc(n.x+h,n.y+f,n.radius,n.start,n.end,n.ccw),l=Q(n,n.end+g),u=V(n,n.end+g),d=Q(n,n.end),c=V(n,n.end),Z(e,t,r,n,d,c,l,u)}function U(e,t,r,n,a,o,i,s){var l,u,d,c,h,f,g;n.arrowRadius&&!r.closed&&(g=Se(s-o,i-a),g-=be,h=r.strokeWidth*Ce(g),f=r.strokeWidth*Le(g),l=i+n.arrowRadius*Ce(g+n.arrowAngle/2),u=s+n.arrowRadius*Le(g+n.arrowAngle/2),d=i+n.arrowRadius*Ce(g-n.arrowAngle/2),c=s+n.arrowRadius*Le(g-n.arrowAngle/2),t.moveTo(l-h,u-f),t.lineTo(i-h,s-f),t.lineTo(d-h,c-f),t.moveTo(i-h,s-f),t.lineTo(i+h,s+f),t.moveTo(i,s))}function K(e,t,r,n,a,o,i,s){n._arrowAngleConverted||(n.arrowAngle*=r._toRad,n._arrowAngleConverted=!0),n.startArrow&&U(e,t,r,n,a,o,i,s)}function Z(e,t,r,n,a,o,i,s){n._arrowAngleConverted||(n.arrowAngle*=r._toRad,n._arrowAngleConverted=!0),n.endArrow&&U(e,t,r,n,a,o,i,s)}function ee(e,t,r,n){var a,o,i;for(a=2,K(e,t,r,n,n.x2+r.x,n.y2+r.y,n.x1+r.x,n.y1+r.y),void 0!==n.x1&&void 0!==n.y1&&t.moveTo(n.x1+r.x,n.y1+r.y);;){if(o=n["x"+a],i=n["y"+a],void 0===o||void 0===i)break;t.lineTo(o+r.x,i+r.y),a+=1}a-=1,Z(e,t,r,n,n["x"+(a-1)]+r.x,n["y"+(a-1)]+r.y,n["x"+a]+r.x,n["y"+a]+r.y)}function te(e,t,r,n){var a,o,i,s,l;for(a=2,K(e,t,r,n,n.cx1+r.x,n.cy1+r.y,n.x1+r.x,n.y1+r.y),void 0!==n.x1&&void 0!==n.y1&&t.moveTo(n.x1+r.x,n.y1+r.y);;){if(o=n["x"+a],i=n["y"+a],s=n["cx"+(a-1)],l=n["cy"+(a-1)],void 0===o||void 0===i||void 0===s||void 0===l)break;t.quadraticCurveTo(s+r.x,l+r.y,o+r.x,i+r.y),a+=1}a-=1,Z(e,t,r,n,n["cx"+(a-1)]+r.x,n["cy"+(a-1)]+r.y,n["x"+a]+r.x,n["y"+a]+r.y)}function re(e,t,r,n){var a,o,i,s,l,u,d,c;for(a=2,o=1,K(e,t,r,n,n.cx1+r.x,n.cy1+r.y,n.x1+r.x,n.y1+r.y),void 0!==n.x1&&void 0!==n.y1&&t.moveTo(n.x1+r.x,n.y1+r.y);;){if(i=n["x"+a],s=n["y"+a],l=n["cx"+o],u=n["cy"+o],d=n["cx"+(o+1)],c=n["cy"+(o+1)],void 0===i||void 0===s||void 0===l||void 0===u||void 0===d||void 0===c)break;t.bezierCurveTo(l+r.x,u+r.y,d+r.x,c+r.y,i+r.x,s+r.y),a+=1,o+=2}a-=1,o-=2,Z(e,t,r,n,n["cx"+(o+1)]+r.x,n["cy"+(o+1)]+r.y,n["x"+a]+r.x,n["y"+a]+r.y)}function ne(e,t,r){return t*=e._toRad,t-=be/2,r*Ce(t)}function ae(e,t,r){return t*=e._toRad,t-=be/2,r*Le(t)}function oe(e,t,r,n){var a,o,i,s,l,u,d,c,h,f,g;for(r===n?(s=0,l=0):(s=r.x,l=r.y),a=1,u=c=f=n.x+s,d=h=g=n.y+l,K(e,t,r,n,u+ne(r,n.a1,n.l1),d+ae(r,n.a1,n.l1),u,d),void 0!==n.x&&void 0!==n.y&&t.moveTo(u,d);;){if(o=n["a"+a],i=n["l"+a],void 0===o||void 0===i)break;c=f,h=g,f+=ne(r,o,i),g+=ae(r,o,i),t.lineTo(f,g),a+=1}Z(e,t,r,n,c,h,f,g)}function ie(e,t,r){isNaN(ve(r.fontSize))||(r.fontSize+="px"),t.font=r.fontStyle+" "+r.fontSize+" "+r.fontFamily}function se(t,r,n,a){var o,i,s,l=Pe.propCache;if(l.text===n.text&&l.fontStyle===n.fontStyle&&l.fontSize===n.fontSize&&l.fontFamily===n.fontFamily&&l.maxWidth===n.maxWidth&&l.lineHeight===n.lineHeight)n.width=l.width,n.height=l.height;else{for(n.width=r.measureText(a[0]).width,s=1;s<a.length;s+=1)(i=r.measureText(a[s]).width)>n.width&&(n.width=i);o=t.style.fontSize,t.style.fontSize=n.fontSize,n.height=pe(e.css(t,"fontSize"))*a.length*n.lineHeight,t.style.fontSize=o}}function le(e,t){var r,n,a,o,i,s,l=String(t.text),u=t.maxWidth,d=l.split("\n"),c=[];for(a=0;a<d.length;a+=1){if(o=d[a],i=o.split(" "),r=[],n="",1===i.length||e.measureText(o).width<u)r=[o];else{for(s=0;s<i.length;s+=1)e.measureText(n+i[s]).width>u&&(""!==n&&r.push(n),n=""),n+=i[s],s!==i.length-1&&(n+=" ");r.push(n)}c=c.concat(r.join("\n").replace(/((\n))|($)/gi,"$2").split("\n"))}return c}var ue,de=t.document,ce=t.Image,he=t.Array,fe=t.getComputedStyle,ge=t.Math,ve=t.Number,pe=t.parseFloat,ye=e.extend,me=e.inArray,we=function(e){return Object.prototype.toString.call(e).slice(8,-1).toLowerCase()},xe=e.isPlainObject,be=ge.PI,_e=ge.round,ke=ge.abs,Le=ge.sin,Ce=ge.cos,Se=ge.atan2,Te=he.prototype.slice,Oe=e.event.fix,Re={},Pe={dataCache:{},propCache:{},imageCache:{}},Xe={rotate:0,scaleX:1,scaleY:1,translateX:0,translateY:0,masks:[]},Ae={},Ye=["mousedown","mousemove","mouseup","mouseover","mouseout","touchstart","touchmove","touchend"],je={events:{},eventHooks:{},future:{}};n.baseDefaults={align:"center",arrowAngle:90,arrowRadius:0,autosave:!0,baseline:"middle",bringToFront:!1,ccw:!1,closed:!1,compositing:"source-over",concavity:0,cornerRadius:0,count:1,cropFromCenter:!0,crossOrigin:null,cursors:null,disableEvents:!1,draggable:!1,dragGroups:null,groups:null,data:null,dx:null,dy:null,end:360,eventX:null,eventY:null,fillStyle:"transparent",fontStyle:"normal",fontSize:"12pt",fontFamily:"sans-serif",fromCenter:!0,height:null,imageSmoothing:!0,inDegrees:!0,intangible:!1,index:null,letterSpacing:null,lineHeight:1,layer:!1,mask:!1,maxWidth:null,miterLimit:10,name:null,opacity:1,r1:null,r2:null,radius:0,repeat:"repeat",respectAlign:!1,restrictDragToAxis:null,rotate:0,rounded:!1,scale:1,scaleX:1,scaleY:1,shadowBlur:0,shadowColor:"transparent",shadowStroke:!1,shadowX:0,shadowY:0,sHeight:null,sides:0,source:"",spread:0,start:0,strokeCap:"butt",strokeDash:null,strokeDashOffset:0,strokeJoin:"miter",strokeStyle:"transparent",strokeWidth:1,sWidth:null,sx:null,sy:null,text:"",translate:0,translateX:0,translateY:0,type:null,visible:!0,width:null,x:0,y:0},ue=new n,r.prototype=ue,je.extend=function(t){return t.name&&(t.props&&ye(ue,t.props),e.fn[t.name]=function e(n){var a,o,i,l,u=this;for(o=0;o<u.length;o+=1)a=u[o],(i=s(a))&&(l=new r(n),Y(a,l,n,e),f(a,i,l),t.fn.call(a,i,l));return u},t.type&&(Re.drawings[t.type]=t.name)),e.fn[t.name]},e.fn.getEventHooks=function(){var e,t,r=this,n={};return 0!==r.length&&(e=r[0],t=m(e),n=t.eventHooks),n},e.fn.setEventHooks=function(e){var t,r,n=this;for(t=0;t<n.length;t+=1)r=m(n[t]),ye(r.eventHooks,e);return n},e.fn.getLayers=function(e){var t,r,n,a,i,s=this,l=[];if(0!==s.length)if(t=s[0],r=m(t),n=r.layers,o(e))for(i=0;i<n.length;i+=1)a=n[i],e.call(t,a)&&l.push(a);else l=n;return l},e.fn.getLayer=function(e){var t,r,n,o,i,s,l=this;if(0!==l.length)if(t=l[0],r=m(t),n=r.layers,s=we(e),e&&e.layer)o=e;else if("number"===s)e<0&&(e=n.length+e),o=n[e];else if("regexp"===s){for(i=0;i<n.length;i+=1)if(a(n[i].name)&&n[i].name.match(e)){o=n[i];break}}else o=r.layer.names[e];return o},e.fn.getLayerGroup=function(e){var t,r,n,a,o,i=this,s=we(e);if(0!==i.length)if(t=i[0],"array"===s)o=e;else if("regexp"===s){r=m(t),n=r.layer.groups;for(a in n)if(a.match(e)){o=n[a];break}}else r=m(t),o=r.layer.groups[e];return o},e.fn.getLayerIndex=function(e){var t=this,r=t.getLayers(),n=t.getLayer(e);return me(n,r)},e.fn.setLayer=function(t,r){var n,a,o,s,u,d,c,h=this;for(a=0;a<h.length;a+=1)if(n=e(h[a]),o=m(h[a]),s=e(h[a]).getLayer(t)){k(n,o,s,r),L(n,o,s,r),l(r);for(u in r)Object.prototype.hasOwnProperty.call(r,u)&&(d=r[u],c=we(d),"object"===c&&xe(d)?(s[u]=ye({},d),l(s[u])):"array"===c?s[u]=d.slice(0):"string"===c?0===d.indexOf("+=")?s[u]+=pe(d.substr(2)):0===d.indexOf("-=")?s[u]-=pe(d.substr(2)):!isNaN(d)&&i(d)&&"text"!==u?s[u]=pe(d):s[u]=d:s[u]=d);w(n,o,s),_(n,o,s),!1===e.isEmptyObject(r)&&A(n,o,s,"change",r)}return h},e.fn.setLayers=function(t,r){var n,a,o,i,s=this;for(a=0;a<s.length;a+=1)for(n=e(s[a]),o=n.getLayers(r),i=0;i<o.length;i+=1)n.setLayer(o[i],t);return s},e.fn.setLayerGroup=function(t,r){var n,a,o,i,s=this;for(a=0;a<s.length;a+=1)if(n=e(s[a]),o=n.getLayerGroup(t))for(i=0;i<o.length;i+=1)n.setLayer(o[i],r);return s},e.fn.moveLayer=function(t,r){var n,a,o,i,s,l=this;for(a=0;a<l.length;a+=1)n=e(l[a]),o=m(l[a]),i=o.layers,(s=n.getLayer(t))&&(s.index=me(s,i),i.splice(s.index,1),i.splice(r,0,s),r<0&&(r=i.length+r),s.index=r,A(n,o,s,"move"));return l},e.fn.removeLayer=function(t){var r,n,a,o,i,s=this;for(n=0;n<s.length;n+=1)r=e(s[n]),a=m(s[n]),o=r.getLayers(),(i=r.getLayer(t))&&(i.index=me(i,o),o.splice(i.index,1),delete i._layer,k(r,a,i,{name:null}),L(r,a,i,{groups:null}),A(r,a,i,"remove"));return s},e.fn.removeLayers=function(t){var r,n,a,o,i,s,l=this;for(n=0;n<l.length;n+=1){for(r=e(l[n]),a=m(l[n]),o=r.getLayers(t).slice(0),s=0;s<o.length;s+=1)i=o[s],r.removeLayer(i);a.layer.names={},a.layer.groups={}}return l},e.fn.removeLayerGroup=function(t){var r,n,a,o,i=this;if(void 0!==t)for(n=0;n<i.length;n+=1)if(r=e(i[n]),a=r.getLayerGroup(t))for(a=a.slice(0),o=0;o<a.length;o+=1)r.removeLayer(a[o]);return i},e.fn.addLayerToGroup=function(t,r){var n,a,o,i=this,s=[r];for(a=0;a<i.length;a+=1)n=e(i[a]),o=n.getLayer(t),o.groups&&(s=o.groups.slice(0),-1===me(r,o.groups)&&s.push(r)),n.setLayer(o,{groups:s});return i},e.fn.removeLayerFromGroup=function(t,r){var n,a,o,i,s=this,l=[];for(a=0;a<s.length;a+=1)n=e(s[a]),o=n.getLayer(t),o.groups&&-1!==(i=me(r,o.groups))&&(l=o.groups.slice(0),l.splice(i,1),n.setLayer(o,{groups:l}));return s},Ae.cursors=["grab","grabbing","zoom-in","zoom-out"],Ae.prefix=function(){var e=fe(de.documentElement,"");return"-"+(Te.call(e).join("").match(/-(moz|webkit|ms)-/)||""===e.OLink&&["","o"])[1]+"-"}(),e.fn.triggerLayerEvent=function(t,r){var n,a,o,i=this;for(a=0;a<i.length;a+=1)n=e(i[a]),o=m(i[a]),(t=n.getLayer(t))&&A(n,o,t,r);return i},e.fn.drawLayer=function(t){var r,n,a,o,i=this;for(r=0;r<i.length;r+=1)a=e(i[r]),(n=s(i[r]))&&(o=a.getLayer(t),S(a,n,o));return i},e.fn.drawLayers=function(t){var r,n,a,o,i,l,d,c,h,f,g,v,p,y=this,w=t||{};for(c=w.index,c||(c=0),n=0;n<y.length;n+=1)if(r=e(y[n]),a=s(y[n])){for(f=m(y[n]),!1!==w.clear&&r.clearCanvas(),w.complete&&(f.drawLayersComplete=w.complete),o=f.layers,d=c;d<o.length;d+=1)if(i=o[d],i.index=d,w.resetFire&&(i._fired=!1),S(r,a,i,d+1),i._masks=f.transforms.masks.slice(0),i._method===e.fn.drawImage&&i.visible){p=!0;break}if(p)continue;h=d,w.complete&&(w.complete.call(y[n]),delete f.drawLayersComplete),i=C(f),g=f.event,v=g.type,f.drag.layer&&T(r,f,v),l=f.lastIntersected,null===l||i===l||!l._hovered||l._fired||f.drag.dragging||(f.lastIntersected=null,l._fired=!0,l._hovered=!1,A(r,f,l,"mouseout"),R(r,f)),i&&(i[v]||(v=I(v)),i._event&&i.intersects&&(f.lastIntersected=i,(i.mouseover||i.mouseout||i.cursors)&&!f.drag.dragging&&(i._hovered||i._fired||(i._fired=!0,i._hovered=!0,A(r,f,i,"mouseover"))),i._fired||(i._fired=!0,g.type=null,A(r,f,i,v)),!i.draggable||i.disableEvents||"mousedown"!==v&&"touchstart"!==v||(f.drag.layer=i,f.originalRedrawOnMousemove=f.redrawOnMousemove,f.redrawOnMousemove=!0))),null!==i||f.drag.dragging||R(r,f),h===o.length&&(f.intersecting.length=0,f.transforms=u(Xe),f.savedTransforms.length=0)}return y},e.fn.addLayer=function(e){var t,n,a=this;for(t=0;t<a.length;t+=1)s(a[t])&&(n=new r(e),n.layer=!0,Y(a[t],n,e));return a},Ae.props=["width","height","opacity","lineHeight"],Ae.propsObj={},e.fn.animateLayer=function(){var t,r,n,a,i,l=this,u=Te.call(arguments,0);for("object"===we(u[2])?(u.splice(2,0,u[2].duration||null),u.splice(3,0,u[3].easing||null),u.splice(4,0,u[4].complete||null),u.splice(5,0,u[5].step||null)):(void 0===u[2]?(u.splice(2,0,null),u.splice(3,0,null),u.splice(4,0,null)):o(u[2])&&(u.splice(2,0,null),u.splice(3,0,null)),void 0===u[3]?(u[3]=null,u.splice(4,0,null)):o(u[3])&&u.splice(3,0,null)),r=0;r<l.length;r+=1)t=e(l[r]),s(l[r])&&(n=m(l[r]),(a=t.getLayer(u[0]))&&a._method!==e.fn.draw&&(i=ye({},u[1]),i=W(l[r],a,i),D(i,!0),D(a),a.style=Ae.propsObj,e(a).animate(i,{duration:u[2],easing:e.easing[u[3]]?u[3]:null,complete:function(e,t,r){return function(){j(r),z(r),t.animating&&t.animated!==r||e.drawLayers(),r._animating=!1,t.animating=!1,t.animated=null,u[4]&&u[4].call(e[0],r),A(e,t,r,"animateend")}}(t,n,a),step:function(e,t,r){return function(n,a){var o,i,s,l=!1;"_"===a.prop[0]&&(l=!0,a.prop=a.prop.replace("_",""),r[a.prop]=r["_"+a.prop]),-1!==a.prop.indexOf(".")&&(o=a.prop.split("."),i=o[0],s=o[1],r[i]&&(r[i][s]=a.now)),r._pos!==a.pos&&(r._pos=a.pos,r._animating||t.animating||(r._animating=!0,t.animating=!0,t.animated=r),t.animating&&t.animated!==r||e.drawLayers()),u[5]&&u[5].call(e[0],n,a,r),A(e,t,r,"animate",a),l&&(a.prop="_"+a.prop)}}(t,n,a)}),A(t,n,a,"animatestart")));return l},e.fn.animateLayerGroup=function(t){var r,n,a,o,i=this,s=Te.call(arguments,0);for(n=0;n<i.length;n+=1)if(r=e(i[n]),a=r.getLayerGroup(t))for(o=0;o<a.length;o+=1)s[0]=a[o],r.animateLayer.apply(r,s);return i},e.fn.delayLayer=function(t,r){var n,a,o,i,s=this;for(r=r||0,a=0;a<s.length;a+=1)n=e(s[a]),o=m(s[a]),(i=n.getLayer(t))&&(e(i).delay(r),A(n,o,i,"delay"));return s},e.fn.delayLayerGroup=function(t,r){var n,a,o,i,s,l=this;for(r=r||0,a=0;a<l.length;a+=1)if(n=e(l[a]),o=n.getLayerGroup(t))for(s=0;s<o.length;s+=1)i=o[s],n.delayLayer(i,r);return l},e.fn.stopLayer=function(t,r){var n,a,o,i,s=this;for(a=0;a<s.length;a+=1)n=e(s[a]),o=m(s[a]),(i=n.getLayer(t))&&(e(i).stop(r),A(n,o,i,"stop"));return s},e.fn.stopLayerGroup=function(t,r){var n,a,o,i,s,l=this;for(a=0;a<l.length;a+=1)if(n=e(l[a]),o=n.getLayerGroup(t))for(s=0;s<o.length;s+=1)i=o[s],n.stopLayer(i,r);return l},function(t){var r;for(r=0;r<t.length;r+=1)e.fx.step[t[r]]=E}(["color","backgroundColor","borderColor","borderTopColor","borderRightColor","borderBottomColor","borderLeftColor","fillStyle","outlineColor","strokeStyle","shadowColor"]),Re.touchEvents={mousedown:"touchstart",mouseup:"touchend",mousemove:"touchmove"},Re.mouseEvents={touchstart:"mousedown",touchend:"mouseup",touchmove:"mousemove"},function(e){var t;for(t=0;t<e.length;t+=1)F(e[t])}(["click","dblclick","mousedown","mouseup","mousemove","mouseover","mouseout","touchstart","touchmove","touchend","pointerdown","pointermove","pointerup","contextmenu"]),e.event.fix=function(t){var r,n,a;t=Oe.call(e.event,t),n=t.originalEvent;var o=1;if(n){"touchmove"==n.type&&n.preventDefault();var i=n.target;if("CANVAS"==i.tagName&&i.getAttribute("jcanvasScale")&&(o=parseInt(i.getAttribute("jcanvasScale"))),a=n.changedTouches,void 0!==t.pageX&&void 0===t.offsetX){r=e(t.currentTarget).offset();try{r&&(t.offsetX=(t.pageX-r.left)*o,t.offsetY=(t.pageY-r.top)*o)}catch(e){}}else if(a)try{r=e(t.currentTarget).offset(),r&&(t.offsetX=(a[0].pageX-r.left)*o,t.offsetY=(a[0].pageY-r.top)*o)}catch(e){}}return t},Re.drawings={arc:"drawArc",bezier:"drawBezier",ellipse:"drawEllipse",function:"draw",image:"drawImage",line:"drawLine",path:"drawPath",polygon:"drawPolygon",slice:"drawSlice",quadratic:"drawQuadratic",rectangle:"drawRect",text:"drawText",vector:"drawVector",save:"saveCanvas",restore:"restoreCanvas",rotate:"rotateCanvas",scale:"scaleCanvas",translate:"translateCanvas"},e.fn.draw=function e(t){var n,a,o=this,i=new r(t);if(Re.drawings[i.type]&&"function"!==i.type)o[Re.drawings[i.type]](t);else for(n=0;n<o.length;n+=1)(a=s(o[n]))&&(i=new r(t),Y(o[n],i,t,e),i.visible&&i.fn&&i.fn.call(o[n],a,i));return o},e.fn.clearCanvas=function e(t){var n,a,o=this,i=new r(t);for(n=0;n<o.length;n+=1)(a=s(o[n]))&&(null===i.width||null===i.height?(a.save(),a.setTransform(1,0,0,1,0,0),a.clearRect(0,0,o[n].width,o[n].height),a.restore()):(Y(o[n],i,t,e),y(o[n],a,i,i.width,i.height),a.clearRect(i.x-i.width/2,i.y-i.height/2,i.width,i.height),v(a,i)));return o},e.fn.saveCanvas=function e(t){var n,a,o,i,l,u=this;for(n=0;n<u.length;n+=1)if(a=s(u[n]))for(i=m(u[n]),o=new r(t),Y(u[n],o,t,e),l=0;l<o.count;l+=1)d(a,i);return u},e.fn.restoreCanvas=function e(t){var n,a,o,i,l,u=this;for(n=0;n<u.length;n+=1)if(a=s(u[n]))for(i=m(u[n]),o=new r(t),Y(u[n],o,t,e),l=0;l<o.count;l+=1)c(a,i);return u},e.fn.rotateCanvas=function e(t){var n,a,o,i,l=this;for(n=0;n<l.length;n+=1)(a=s(l[n]))&&(i=m(l[n]),o=new r(t),Y(l[n],o,t,e),o.autosave&&d(a,i),N(a,o,i.transforms));return l},e.fn.scaleCanvas=function e(t){var n,a,o,i,l=this;for(n=0;n<l.length;n+=1)(a=s(l[n]))&&(i=m(l[n]),o=new r(t),Y(l[n],o,t,e),o.autosave&&d(a,i),M(a,o,i.transforms));return l},e.fn.translateCanvas=function e(t){var n,a,o,i,l=this;for(n=0;n<l.length;n+=1)(a=s(l[n]))&&(i=m(l[n]),o=new r(t),Y(l[n],o,t,e),o.autosave&&d(a,i),J(a,o,i.transforms));return l},e.fn.drawRect=function e(t){var n,a,o,i,l,u,d,c,h,g=this;for(n=0;n<g.length;n+=1)(a=s(g[n]))&&(o=new r(t),Y(g[n],o,t,e),o.visible&&(y(g[n],a,o,o.width,o.height),f(g[n],a,o),a.beginPath(),o.width&&o.height&&(i=o.x-o.width/2,l=o.y-o.height/2,c=ke(o.cornerRadius),c?(u=o.x+o.width/2,d=o.y+o.height/2,o.width<0&&(h=i,i=u,u=h),o.height<0&&(h=l,l=d,d=h),u-i-2*c<0&&(c=(u-i)/2),d-l-2*c<0&&(c=(d-l)/2),a.moveTo(i+c,l),a.lineTo(u-c,l),a.arc(u-c,l+c,c,3*be/2,2*be,!1),a.lineTo(u,d-c),a.arc(u-c,d-c,c,0,be/2,!1),a.lineTo(i+c,d),a.arc(i+c,d-c,c,be/2,be,!1),a.lineTo(i,l+c),a.arc(i+c,l+c,c,be,3*be/2,!1),o.closed=!0):a.rect(i,l,o.width,o.height)),B(g[n],a,o),p(g[n],a,o)));return g},e.fn.drawArc=function e(t){var n,a,o,i=this;for(n=0;n<i.length;n+=1)(a=s(i[n]))&&(o=new r(t),Y(i[n],o,t,e),o.visible&&(y(i[n],a,o,2*o.radius),f(i[n],a,o),a.beginPath(),$(i[n],a,o,o),B(i[n],a,o),p(i[n],a,o)));return i},e.fn.drawEllipse=function e(t){var n,a,o,i,l,u=this;for(n=0;n<u.length;n+=1)(a=s(u[n]))&&(o=new r(t),Y(u[n],o,t,e),o.visible&&(y(u[n],a,o,o.width,o.height),f(u[n],a,o),i=o.width*(4/3),l=o.height,a.beginPath(),a.moveTo(o.x,o.y-l/2),a.bezierCurveTo(o.x-i/2,o.y-l/2,o.x-i/2,o.y+l/2,o.x,o.y+l/2),a.bezierCurveTo(o.x+i/2,o.y+l/2,o.x+i/2,o.y-l/2,o.x,o.y-l/2),B(u[n],a,o),o.closed=!0,p(u[n],a,o)));return u},e.fn.drawPolygon=function e(t){var n,a,o,i,l,u,d,c,h,g,v=this;for(n=0;n<v.length;n+=1)if((a=s(v[n]))&&(o=new r(t),Y(v[n],o,t,e),o.visible)){for(y(v[n],a,o,2*o.radius),f(v[n],a,o),l=2*be/o.sides,u=l/2,i=u+be/2,d=o.radius*Ce(u),a.beginPath(),g=0;g<o.sides;g+=1)c=o.x+o.radius*Ce(i),h=o.y+o.radius*Le(i),a.lineTo(c,h),o.concavity&&(c=o.x+(d+-d*o.concavity)*Ce(i+u),h=o.y+(d+-d*o.concavity)*Le(i+u),a.lineTo(c,h)),i+=l;B(v[n],a,o),o.closed=!0,p(v[n],a,o)}return v},e.fn.drawSlice=function e(t){var n,a,o,i,l,u,d=this;for(n=0;n<d.length;n+=1)(a=s(d[n]))&&(o=new r(t),Y(d[n],o,t,e),o.visible&&(y(d[n],a,o,2*o.radius),f(d[n],a,o),o.start*=o._toRad,o.end*=o._toRad,o.start-=be/2,o.end-=be/2,o.start=q(o.start),o.end=q(o.end),o.end<o.start&&(o.end+=2*be),i=(o.start+o.end)/2,l=o.radius*o.spread*Ce(i),u=o.radius*o.spread*Le(i),o.x+=l,o.y+=u,a.beginPath(),a.arc(o.x,o.y,o.radius,o.start,o.end,o.ccw),a.lineTo(o.x,o.y),B(d[n],a,o),o.closed=!0,p(d[n],a,o)));return d},e.fn.drawLine=function e(t){var n,a,o,i=this;for(n=0;n<i.length;n+=1)(a=s(i[n]))&&(o=new r(t),Y(i[n],o,t,e),o.visible&&(y(i[n],a,o),f(i[n],a,o),a.beginPath(),ee(i[n],a,o,o),B(i[n],a,o),p(i[n],a,o)));return i},e.fn.drawQuadratic=function e(t){var n,a,o,i=this;for(n=0;n<i.length;n+=1)(a=s(i[n]))&&(o=new r(t),Y(i[n],o,t,e),o.visible&&(y(i[n],a,o),f(i[n],a,o),a.beginPath(),te(i[n],a,o,o),B(i[n],a,o),p(i[n],a,o)));return i},e.fn.drawBezier=function e(t){var n,a,o,i=this;for(n=0;n<i.length;n+=1)(a=s(i[n]))&&(o=new r(t),Y(i[n],o,t,e),o.visible&&(y(i[n],a,o),f(i[n],a,o),a.beginPath(),re(i[n],a,o,o),B(i[n],a,o),p(i[n],a,o)));return i},e.fn.drawVector=function e(t){var n,a,o,i=this;for(n=0;n<i.length;n+=1)(a=s(i[n]))&&(o=new r(t),Y(i[n],o,t,e),o.visible&&(y(i[n],a,o),f(i[n],a,o),a.beginPath(),oe(i[n],a,o,o),B(i[n],a,o),p(i[n],a,o)));return i},e.fn.drawPath=function e(t){var n,a,o,i,l,u=this;for(n=0;n<u.length;n+=1)if((a=s(u[n]))&&(o=new r(t),Y(u[n],o,t,e),o.visible)){for(y(u[n],a,o),f(u[n],a,o),a.beginPath(),i=1;;){if(void 0===(l=o["p"+i]))break;l=new r(l),"line"===l.type?ee(u[n],a,o,l):"quadratic"===l.type?te(u[n],a,o,l):"bezier"===l.type?re(u[n],a,o,l):"vector"===l.type?oe(u[n],a,o,l):"arc"===l.type&&$(u[n],a,o,l),i+=1}B(u[n],a,o),p(u[n],a,o)}return u},e.fn.drawText=function e(t){var n,a,o,i,l,u,d,c,h,g,p,m,w,x,b=this;for(n=0;n<b.length;n+=1)if((a=s(b[n]))&&(o=new r(t),Y(b[n],o,t,e),o.visible)){if(a.textBaseline=o.baseline,a.textAlign=o.align,ie(b[n],a,o),l=null!==o.maxWidth?le(a,o):o.text.toString().split("\n"),se(b[n],a,o,l),i&&(i.width=o.width,i.height=o.height),y(b[n],a,o,o.width,o.height),f(b[n],a,o),w=o.x,"left"===o.align?o.respectAlign?o.x+=o.width/2:w-=o.width/2:"right"===o.align&&(o.respectAlign?o.x-=o.width/2:w+=o.width/2),o.radius)for(c=pe(o.fontSize),null===o.letterSpacing&&(o.letterSpacing=c/500),d=0;d<l.length;d+=1){for(a.save(),a.translate(o.x,o.y),u=l[d],o.flipArcText&&(g=u.split(""),g.reverse(),u=g.join("")),h=u.length,a.rotate(-be*o.letterSpacing*(h-1)/2),m=0;m<h;m+=1)p=u[m],0!==m&&a.rotate(be*o.letterSpacing),a.save(),a.translate(0,-o.radius),o.flipArcText&&a.scale(-1,-1),a.fillText(p,0,0),"transparent"!==o.fillStyle&&(a.shadowColor="transparent"),0!==o.strokeWidth&&a.strokeText(p,0,0),a.restore();o.radius-=c,o.letterSpacing+=c/(1e3*be),a.restore()}else for(d=0;d<l.length;d+=1)u=l[d],x=o.y+d*o.height/l.length-(l.length-1)*o.height/l.length/2,a.shadowColor=o.shadowColor,a.fillText(u,w,x),"transparent"!==o.fillStyle&&(a.shadowColor="transparent"),0!==o.strokeWidth&&a.strokeText(u,w,x);x=0,"top"===o.baseline?x+=o.height/2:"bottom"===o.baseline&&(x-=o.height/2),o._event&&(a.beginPath(),a.rect(o.x-o.width/2,o.y-o.height/2+x,o.width,o.height),B(b[n],a,o),a.closePath()),v(a,o)}return Pe.propCache=o,b},e.fn.measureText=function(e){var t,n,a,o=this;return n=o.getLayer(e),(!n||n&&!n._layer)&&(n=new r(e)),t=s(o[0]),t&&(ie(o[0],t,n),a=null!==n.maxWidth?le(t,n):n.text.split("\n"),se(o[0],t,n,a)),n},e.fn.drawImage=function t(n){function a(e,t,r,n,a){null===n.width&&null===n.sWidth&&(n.width=n.sWidth=p.width),null===n.height&&null===n.sHeight&&(n.height=n.sHeight=p.height),a&&(a.width=n.width,a.height=n.height),null!==n.sWidth&&null!==n.sHeight&&null!==n.sx&&null!==n.sy?(null===n.width&&(n.width=n.sWidth),null===n.height&&(n.height=n.sHeight),n.cropFromCenter&&(n.sx+=n.sWidth/2,n.sy+=n.sHeight/2),n.sy-n.sHeight/2<0&&(n.sy=n.sHeight/2),n.sy+n.sHeight/2>p.height&&(n.sy=p.height-n.sHeight/2),n.sx-n.sWidth/2<0&&(n.sx=n.sWidth/2),n.sx+n.sWidth/2>p.width&&(n.sx=p.width-n.sWidth/2),y(e,t,n,n.width,n.height),f(e,t,n),t.drawImage(p,n.sx-n.sWidth/2,n.sy-n.sHeight/2,n.sWidth,n.sHeight,n.x-n.width/2,n.y-n.height/2,n.width,n.height)):(y(e,t,n,n.width,n.height),f(e,t,n),t.drawImage(p,n.x-n.width/2,n.y-n.height/2,n.width,n.height)),t.beginPath(),t.rect(n.x-n.width/2,n.y-n.height/2,n.width,n.height),B(e,t,n),t.closePath(),v(t,n),g(t,r,n)}function o(t,r,n,o,i){return function(){var s=e(t);if(a(t,r,n,o,i),o.layer?A(s,n,i,"load"):o.load&&o.load.call(s[0],i),o.layer&&(i._masks=n.transforms.masks.slice(0),o._next)){var l=n.drawLayersComplete;delete n.drawLayersComplete,
s.drawLayers({clear:!1,resetFire:!0,index:o._next,complete:l})}}}var i,l,u,d,c,h,p,w,x,b=this,_=Pe.imageCache;for(l=0;l<b.length;l+=1)i=b[l],(u=s(b[l]))&&(d=m(b[l]),c=new r(n),h=Y(b[l],c,n,t),c.visible&&(x=c.source,w=x.getContext,x.src||w?p=x:x&&(_[x]&&_[x].complete?p=_[x]:(p=new ce,x.match(/^data:/i)||(p.crossOrigin=c.crossOrigin),p.src=x,_[x]=p)),p&&(p.complete||w?o(i,u,d,c,h)():(p.onload=o(i,u,d,c,h),p.src=p.src))));return b},e.fn.createPattern=function(t){function n(){d=a.createPattern(l,i.repeat),i.load&&i.load.call(h[0],d)}var a,i,l,u,d,c,h=this;return a=s(h[0]),a?(i=new r(t),c=i.source,o(c)?(l=e("<canvas />")[0],l.width=i.width,l.height=i.height,u=s(l),c.call(l,u),n()):(u=c.getContext,c.src||u?l=c:(l=new ce,c.match(/^data:/i)||(l.crossOrigin=i.crossOrigin),l.src=c),l.complete||u?n():(l.onload=n,l.src=l.src))):d=null,d},e.fn.createGradient=function(e){var t,n,a,o,i,l,u,d,c,h,f=this,g=[];if(n=new r(e),t=s(f[0])){for(n.x1=n.x1||0,n.y1=n.y1||0,n.x2=n.x2||0,n.y2=n.y2||0,a=null!==n.r1&&null!==n.r2?t.createRadialGradient(n.x1,n.y1,n.r1,n.x2,n.y2,n.r2):t.createLinearGradient(n.x1,n.y1,n.x2,n.y2),u=1;void 0!==n["c"+u];u+=1)void 0!==n["s"+u]?g.push(n["s"+u]):g.push(null);for(o=g.length,null===g[0]&&(g[0]=0),null===g[o-1]&&(g[o-1]=1),u=0;u<o;u+=1){if(null!==g[u]){for(c=1,h=0,i=g[u],d=u+1;d<o;d+=1){if(null!==g[d]){l=g[d];break}c+=1}i>l&&(g[d]=g[u])}else null===g[u]&&(h+=1,g[u]=i+h*((l-i)/c));a.addColorStop(g[u],n["c"+(u+1)])}}else a=null;return a},e.fn.setPixels=function e(t){var n,a,o,i,l,u,d,c,h,f,g=this;for(a=0;a<g.length;a+=1)if(n=g[a],o=s(n),i=m(g[a]),o&&(l=new r(t),Y(n,l,t,e),y(g[a],o,l,l.width,l.height),null!==l.width&&null!==l.height||(l.width=n.width,l.height=n.height,l.x=l.width/2,l.y=l.height/2),0!==l.width&&0!==l.height)){if(d=o.getImageData((l.x-l.width/2)*i.pixelRatio,(l.y-l.height/2)*i.pixelRatio,l.width*i.pixelRatio,l.height*i.pixelRatio),c=d.data,f=c.length,l.each)for(h=0;h<f;h+=4)u={r:c[h],g:c[h+1],b:c[h+2],a:c[h+3]},l.each.call(n,u,l),c[h]=u.r,c[h+1]=u.g,c[h+2]=u.b,c[h+3]=u.a;o.putImageData(d,(l.x-l.width/2)*i.pixelRatio,(l.y-l.height/2)*i.pixelRatio),o.restore()}return g},e.fn.getCanvasImage=function(e,t){var r,n=this,a=null;return 0!==n.length&&(r=n[0],r.toDataURL&&(void 0===t&&(t=1),a=r.toDataURL("image/"+e,t))),a},e.fn.detectPixelRatio=function(e){var r,n,a,o,i,l,u,d,c,h=this;for(n=0;n<h.length;n+=1)r=h[n],a=s(r),c=m(h[n]),c.scaled||(o=t.devicePixelRatio||1,i=a.webkitBackingStorePixelRatio||a.mozBackingStorePixelRatio||a.msBackingStorePixelRatio||a.oBackingStorePixelRatio||a.backingStorePixelRatio||1,l=o/i,1!==l&&(u=r.width,d=r.height,r.width=u*l,r.height=d*l,r.style.width=u+"px",r.style.height=d+"px",a.scale(l,l)),c.pixelRatio=l,c.scaled=!0,e&&e.call(r,l));return h},je.clearCache=function(){var e;for(e in Pe)Object.prototype.hasOwnProperty.call(Pe,e)&&(Pe[e]={})},e.support.canvas=void 0!==e("<canvas />")[0].getContext,ye(je,{defaults:ue,setGlobalProps:f,transformShape:y,detectEvents:B,closePath:p,setCanvasFont:ie,measureText:se}),e.jCanvas=je,e.jCanvasObject=r});